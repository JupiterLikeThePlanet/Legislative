

<!DOCTYPE html>
<html>
  <head>
    <title>Legislative</title>
    <link rel="shortcut icon" href="../images/favicon.ico" />
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="/javascripts/global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.js"></script>
    <script type='text/javascript', src="http://code.highcharts.com/highcharts.js"></script>
    <script type='text/javascript', src="http://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/heatmap.js"></script>
<script src="https://code.highcharts.com/modules/treemap.js"></script>
<!-- <script src="https://d3js.org/d3.v3.min.js"></script> -->
  </head>
  <body>
    <h1>Legislative</h1>
    <p>Stay up to date on current bills hitting the house and senate floors</p>
    <div id="wrapper">

      <!-- ** CHART ** -->
      <canvas id="myChart" width="600" height="600"></canvas>
      <script>

        var ctx = document.getElementById("myChart").getContext("2d");

        $.ajax({
          type: 'GET',
          url: '/bills/bill_data'
        }).done(function(response){
          var bill_data = response;
          new Chart(ctx).PolarArea(bill_data, {animation:true, animationSteps: 250, animateRotate : true, animateScale : true});
        });
      </script>
      <!-- ** END ** -->

      <h2>BILL List</h2>
      <button id="table_congress_list">113</button>
      <div id="billList">
        <table>
          <thead>
            <th>BillName</th>
            <th>Description</th>
            <th>Show</th>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    <div>
    <h1>Bill in this Congressional Session</h1>
    <canvas id="current_session" width="600" height="600"></canvas>

    <script>
      var congress = document.getElementById("current_session").getContext("2d");

      var sessionData = {
        labels: ["Agriculture", "Education", "Defense", "Water Mgmt", "NASA", "HUD", "Immigration"],
        datasets: [
          {
            label: "Active",
            fillColor: "rgba(220,220,220,0.5)",
            strokeColor: "rgba(220,220,220,0.8)",
            highlightFill: "rgba(220,220,220,0.75)",
            highlightStroke: "rgba(220,220,220,1)",
            data: [65, 59, 80, 81, 56, 55, 90]
          }
        ]
      };
      new Chart(congress).Bar(sessionData, {scaleShowHorizontalLines: false, barStrokeWidth : 1});

    </script>
    </div>

    <h1>Active, Pass, Fail status of bills in this Congressional Session</h1>
    <canvas id="session_status" width="600" height="600"></canvas>

    <script>
      var congress = document.getElementById("session_status").getContext("2d");

      var sessionData = {
        labels: ["Agriculture", "Education", "Defense", "Water Mgmt", "NASA", "HUD", "Immigration"],
        datasets: [
          {
            label: "Active",
            fillColor: "rgba(220,220,220,0.5)",
            strokeColor: "rgba(220,220,220,0.8)",
            highlightFill: "rgba(220,220,220,0.75)",
            highlightStroke: "rgba(220,220,220,1)",
            data: [65, 59, 80, 81, 56, 55, 90]
          },
          {
            label: "Passed",
            fillColor: "rgba(151,187,205,0.5)",
            strokeColor: "rgba(151,187,205,0.8)",
            highlightFill: "rgba(151,187,205,0.75)",
            highlightStroke: "rgba(151,187,205,1)",
            data: [28, 48, 40, 19, 86, 27, 40]
          },
                    {
            label: "Dead",
            fillColor: "rgba(151,187,205,0.5)",
            strokeColor: "rgba(151,187,205,0.8)",
            highlightFill: "rgba(151,187,205,0.75)",
            highlightStroke: "rgba(151,187,205,1)",
            data: [28, 18, 10, 29, 46, 57, 50]
          }
        ]
      };
      new Chart(congress).Bar(sessionData, {scaleShowHorizontalLines: true});
      // window.onload = function(){
      // var congress = document.getElementById("session_status").getContext("2d");
      // window.myBarChart = new Chart(congress).Bar(sessionData, {scaleShowHorizontalLines: true, responsive : true});
      //     for (i = 0, i < datasets, i++) {
      //     myBarChart.datasets[i].bars[i].fillColor = getRandomColor(); //bar 1
      //     // myBarChart.datasets[0].bars[1].fillColor = "orange"; //bar 2
      //     // myBarChart.datasets[0].bars[2].fillColor = "red"; //bar 3
      //     myBarChart.update();
      //   }
      // }
      // var myBarChart = new Chart(congress).Bar(sessionData, scaleShowHorizontalLines: true);
    </script>
    </div>

    <div id="session" style="width:100%; height:400px;">
      <script>
        $(function () {
    $('#session').highcharts({
        chart: {
            type: 'bar'
        },
        title: {
            text: 'Active, Pass, Fail status of bills in this Congressional Session'
        },
        xAxis: {
            categories: ["Agriculture", "Education", "Defense", "Water Mgmt", "NASA", "HUD", "Immigration"]
        },
        yAxis: {
            title: {
                text: 'Status'
            }
        },
        series: [{
            name: 'Active',
            data: [5, 7, 3]
        }, {
            name: 'Pass',
            data: [2,3,1]
        }, {
            name: 'Fail',
            data: [1, 0, 2]
        }]
    });
});
      </script>

    </div>

<!-- start code on expandHighCharts branch -->
  <div id="houseVsSenate" style="min-width: 310px; max-width: 800px; height: 400px; margin: 0 auto"></div>
  <script>
  $(function () {

    var categories = ['Agriculture', 'DARPA', 'Education', 'Defense',
            'Water', 'Climate Change', 'Foreign Relations', 'Immigration', 'Veteran Affairs',
            'Defunding Saskatoon ', 'Appropriations', 'Ethics', 'Judiciary', 'Rules',
            'Budget', 'Small Business', 'Ways & Means', 'Homeland Security', 'Environment and Public Works',
            'Energy and National Resources', 'Science, Space, & Tech'];
    $(document).ready(function () {
        $('#houseVsSenate').highcharts({
            chart: {
                type: 'bar'
            },
            title: {
                text: 'House vs. Senate'
            },
            // subtitle: {
            //     text: 'Source: <a href="http://populationpyramid.net/germany/2015/">Population Pyramids of the World from 1950 to 2100</a>'
            // },
            xAxis: [{
                categories: categories,
                reversed: false,
                labels: {
                    step: 1
                }
            }, { // mirror axis on right side
                opposite: true,
                reversed: false,
                categories: categories,
                linkedTo: 0,
                labels: {
                    step: 1
                }
            }],
            yAxis: {
                title: {
                    text: 'Committees'
                },
                labels: {
                    formatter: function () {

                        return Math.abs(this.value);
                    }
                }
            },

            plotOptions: {
                series: {
                    stacking: 'normal'
                }
            },

            tooltip: {
                formatter: function () {
                    return '<b>' + this.series.name + ', age ' + this.point.category + '</b><br/>' +
                        'Population: ' + Highcharts.numberFormat(Math.abs(this.point.y), 0);
                }
            },

            series: [{
                name: 'House',
                data: [-2.2, -2.2, -2.3, -2.5, -2.7, -3.1, -3.2,
                    -3.0, -3.2, -4.3, -4.4, -3.6, -3.1, -2.4,
                    -2.5, -2.3, -1.2, -0.6, -0.2, -0.0, -0.0]
            }, {
                name: 'Senate',
                data: [2.1, 2.0, 2.2, 2.4, 2.6, 3.0, 3.1, 2.9,
                    3.1, 4.1, 4.3, 3.6, 3.4, 2.6, 2.9, 2.9,
                    1.8, 1.2, 0.6, 0.1, 0.0]
            }]
        });
    });

});
</script>

<div id="bill-by-committee">

<script>
  $(function () {
    var data = {
            'Aging': {
                'Bill to help old people like Mary': {
                    'Communicable & other Group I': '75.5',
                    'Injuries': '89.0',
                    'Noncommunicable diseases': '501.2'
                },
                'The Mitochondrial Free Radical Theory of Aging': {
                    'Noncommunicable diseases': '548.9',
                    'Injuries': '64.0',
                    'Communicable & other Group I': '234.6'
                },
                ' Rejuvenation Research': {
                    'Communicable & other Group I': '316.4',
                    'Injuries': '102.0',
                    'Noncommunicable diseases': '708.7'
                },
                'Aubrey de Grey': {
                    'Injuries': '35.0',
                    'Noncommunicable diseases': '487.2',
                    'Communicable & other Group I': '59.2'
                },
                'SENS Research Foundation': {
                    'Injuries': '91.9',
                    'Noncommunicable diseases': '751.4',
                    'Communicable & other Group I': '117.3'
                },

            },
            'Small Business': {
                'Awesome bill to help small business owners': {
                    'Communicable & other Group I': '16.8',
                    'Noncommunicable diseases': '602.8',
                    'Injuries': '44.3'
                },
                'Another bill to help SM get health care': {
                    'Communicable & other Group I': '22.6',
                    'Noncommunicable diseases': '494.5',
                    'Injuries': '48.9'
                },
            },

        },
        points = [],
        regionP,
        regionVal,
        regionI = 0,
        countryP,
        countryI,
        causeP,
        causeI,
        region,
        country,
        cause,
        causeName = {
            'Bill ID': 'Communicable diseases',
            'Noncommunicable diseases': 'Non-communicable diseases',
            'url': 'link to gov site'

        };

    for (region in data) {
        if (data.hasOwnProperty(region)) {
            regionVal = 0;
            regionP = {
                // description: "blaaaaah",
                // url: "www.poik.com",
                id: 'id_' + regionI,
                name: region,
                color: Highcharts.getOptions().colors[regionI]
            };
            countryI = 0;
            for (country in data[region]) {
                if (data[region].hasOwnProperty(country)) {
                    countryP = {
                        id: regionP.id + '_' + countryI,
                        name: country,
                        parent: regionP.id
                    };
                    points.push(countryP);
                    causeI = 0;
                    for (cause in data[region][country]) {
                        if (data[region][country].hasOwnProperty(cause)) {
                            causeP = {
                                id: countryP.id + '_' + causeI,
                                name: causeName[cause],
                                parent: countryP.id,
                                value: Math.round(+data[region][country][cause])
                            };
                            regionVal += causeP.value;
                            points.push(causeP);
                            causeI = causeI + 1;
                        }
                    }
                    countryI = countryI + 1;
                }
            }
            regionP.value = Math.round(regionVal / countryI);
            points.push(regionP);
            regionI = regionI + 1;
        }
    }
    $('#bill-by-committee').highcharts({
        series: [{
            type: 'treemap',
            layoutAlgorithm: 'squarified',
            allowDrillToNode: true,
            dataLabels: {
                enabled: false
            },
            levelIsConstant: false,
            levels: [{
                level: 1,
                layoutAlgorithm: 'stripes',
                color: 'red',
                dataLabels: {
                    enabled: true
                },
                borderWidth: 3
            }],
            data: points
        }],


        title: {
            text: 'Bills by Committee (Per Session)'
        }
    });
});
</script>
</div>


  </body>
</html>
